{"version":3,"sources":["routes/CreateRoom.js","routes/Room.js","App.js","index.js"],"names":["CreateRoom","props","className","type","onClick","id","uuid","history","push","Container","styled","div","StyledVideo","video","Video","ref","useRef","useEffect","peer","on","stream","current","srcObject","playsInline","autoPlay","videoConstraints","height","window","innerHeight","width","innerWidth","socket","io","connect","console","log","Room","useState","peers","setPeers","userVideo","peersRef","roomID","match","params","navigator","mediaDevices","getUserMedia","audio","then","emit","users","forEach","userID","userToSignal","callerID","Peer","initiator","trickle","signal","createPeer","peerID","payload","incomingSignal","addPeer","find","p","muted","map","index","_remoteStreams","key","App","path","exact","component","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.b3674cfe.chunk.js","sourcesContent":["import React from \"react\";\nimport { v1 as uuid } from \"uuid\";\n\nconst CreateRoom = (props) => {\n  function create() {\n    const id = uuid();\n    props.history.push(`/room/${id}`);\n  }\n\n  return (\n    <div className=\"d-flex justify-content-center align-items-center vh-100\">\n      <div className=\"d-grid gap-2 col-2\">\n        <button\n          type=\"button\"\n          className=\"btn btn-outline-primary btn-lg\"\n          onClick={create}\n        >\n          Create Meeting\n        </button>\n      </div>\n    </div>\n  );\n};\n\nexport default CreateRoom;\n","import React, { useEffect, useRef, useState } from \"react\";\nimport io from \"socket.io-client\";\nimport Peer from \"simple-peer\";\nimport styled from \"styled-components\";\n\nconst Container = styled.div`\n  padding: 20px;\n  display: flex;\n  height: 100vh;\n  width: 90%;\n  margin: auto;\n  flex-wrap: wrap;\n`;\n\nconst StyledVideo = styled.video`\n  height: 40%;\n  width: 50%;\n`;\n\nconst Video = (props) => {\n  const ref = useRef();\n  useEffect(() => {\n    props.peer.on(\"stream\", (stream) => {\n      ref.current.srcObject = stream;\n    });\n  }, [props.peer]);\n\n  return <StyledVideo playsInline autoPlay ref={ref} />;\n};\n\nconst videoConstraints = {\n  height: window.innerHeight / 2,\n  width: window.innerWidth / 2,\n};\n\nconst socket = io.connect(\n  \"https://videochatserver-evr8.onrender.com\"\n);\nconsole.log(socket);\n\nconst Room = (props) => {\n  const [peers, setPeers] = useState([]);\n  // const socketRef = useRef();\n  const userVideo = useRef();\n  const peersRef = useRef([]);\n  const roomID = props.match.params.roomID;\n  console.log(props);\n  useEffect(() => {\n    navigator.mediaDevices\n      .getUserMedia({ video: videoConstraints, audio: true })\n      .then((stream) => {\n        userVideo.current.srcObject = stream;\n        socket.emit(\"join room\", roomID);\n        socket.on(\"all users\", (users) => {\n          const peers = [];\n          users.forEach((userID) => {\n            const peer = createPeer(userID, socket.id, stream);\n            peersRef.current.push({\n              peerID: userID,\n              peer,\n            });\n            peers.push(peer);\n          });\n          setPeers(peers);\n        });\n\n        socket.on(\"user joined\", (payload) => {\n          const peer = addPeer(payload.signal, payload.callerID, stream);\n          peersRef.current.push({\n            peerID: payload.callerID,\n            peer,\n          });\n\n          setPeers((users) => [...users, peer]);\n        });\n\n        socket.on(\"receiving returned signal\", (payload) => {\n          const item = peersRef.current.find((p) => p.peerID === payload.id);\n          item.peer.signal(payload.signal);\n        });\n      });\n  }, [roomID]);\n\n  function createPeer(userToSignal, callerID, stream) {\n    const peer = new Peer({\n      initiator: true,\n      trickle: false,\n      stream,\n    });\n\n    peer.on(\"signal\", (signal) => {\n      socket.emit(\"sending signal\", {\n        userToSignal,\n        callerID,\n        signal,\n      });\n    });\n\n    return peer;\n  }\n\n  function addPeer(incomingSignal, callerID, stream) {\n    const peer = new Peer({\n      initiator: false,\n      trickle: false,\n      stream,\n    });\n\n    peer.on(\"signal\", (signal) => {\n      socket.emit(\"returning signal\", { signal, callerID });\n    });\n\n    peer.signal(incomingSignal);\n\n    return peer;\n  }\n\n  return (\n    <Container>\n      <StyledVideo muted ref={userVideo} autoPlay playsInline />\n      {peers.map((peer, index) => {\n        if (peer._remoteStreams != null) {\n          return <Video key={index} peer={peer} />;\n        }\n        return null;\n      })}\n    </Container>\n  );\n};\n\nexport default Room;\n","import React from 'react';\nimport { BrowserRouter, Route, Switch } from \"react-router-dom\";\nimport CreateRoom from \"./routes/CreateRoom\";\nimport Room from \"./routes/Room\";\n\nfunction App() {\n  return (\n    <BrowserRouter>\n      <Switch>\n        <Route path=\"/\" exact component={CreateRoom} />\n        <Route path=\"/room/:roomID\" component={Room} />\n      </Switch>\n    </BrowserRouter>\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\n\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);"],"sourceRoot":""}